(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,a){e.exports=a(41)},32:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=(a(22),a(32),a(3)),i=a(4),l=a(6),s=a(5),u=a(7),m=a(8),p=a.n(m),d=a(13),h=a(11),f=a(1),b=a.n(f);a(35),a(42);b.a.initializeApp({apiKey:"AIzaSyCPGFeo3lBMe4Pl33ZbW77sBRwCsEdiN58",authDomain:"think-piece-shipu.firebaseapp.com",databaseURL:"https://think-piece-shipu.firebaseio.com",projectId:"think-piece-shipu",storageBucket:"think-piece-shipu.appspot.com",messagingSenderId:"496779419645",appId:"1:496779419645:web:0928c7aa2f078fe5eb8394",measurementId:"G-JWD5NTGS6W"});var v=b.a.firestore(),y=b.a.auth(),E=new b.a.auth.GoogleAuthProvider,g=function(){return y.signInWithPopup(E)},j=function(){return y.signOut()},O=b.a.storage(),C=function(){var e=Object(h.a)(p.a.mark(function e(t,a){var n,r,c,o,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=v.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=17;break}return r=t.displayName,c=t.email,o=t.photoURL,i=new Date,e.prev=9,e.next=12,n.set(Object(d.a)({displayName:r,email:c,photoURL:o,createdAt:i},a));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.error(e.t0);case 17:return e.abrupt("return",w(t.uid));case 18:case"end":return e.stop()}},e,null,[[9,14]])}));return function(t,a){return e.apply(this,arguments)}}(),w=function(e){if(!e)return null;try{return v.collection("users").doc(e)}catch(t){console.error("error in fetching data",t)}};window.firebase=b.a;b.a;var N=a(14),S=a.n(N),k=Object(n.createContext)(),A=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={user:null},a.unsubscribeFromAuth=null,a.unsubscribeFromUserCollection=null,a.componentDidMount=function(){a.unsubscribeFromAuth=y.onAuthStateChanged(function(){var e=Object(h.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:(n=e.sent)?a.unsubscribeFromUserCollection=n.onSnapshot(function(e){a.setState({user:Object(d.a)({uid:e.id},e.data())})}):a.setState({user:null});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},a.componentWillUnmount=function(){a.unsubscribeFromAuth()},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.children,t=this.state.user;return r.a.createElement(k.Provider,{value:t},e)}}]),t}(n.Component),x=a(44),U=function(e){var t=e.id,a=e.title,c=e.content,o=e.user,i=e.createdAt,l=e.stars,s=e.comments,u=Object(n.useContext)(k),m=v.doc("posts/".concat(t));return r.a.createElement("article",{className:"Post"},r.a.createElement("div",{className:"Post--content"},r.a.createElement(x.a,{to:"posts/".concat(t)},r.a.createElement("h3",null,a)),r.a.createElement("div",null,c)),r.a.createElement("div",{className:"Post--meta"},r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"star"},"\u2b50\ufe0f"),l),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"comments"},"\ud83d\ude4a"),s),r.a.createElement("p",null,"Posted by ",o.displayName),r.a.createElement("p",null,S()(i.toDate()).calendar())),r.a.createElement("div",null,r.a.createElement("button",{className:"star",onClick:function(){m.update({stars:l+1})}},"Star"),function(e,t){return!!e&&e.uid===t.uid}(u,o)?r.a.createElement("button",{className:"delete",onClick:function(){m.delete()}},"Delete"):null)))};U.defaultProps={title:"An Incredibly Hot Take",content:"Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ducimus est aut dolorem, dolor voluptatem assumenda possimus officia blanditiis iusto porro eaque non ab autem nihil! Alias repudiandae itaque quo provident.",user:{id:"123",displayName:"Bill Murray",email:"billmurray@mailinator.com",photoURL:"https://www.fillmurray.com/300/300"},createdAt:new Date,stars:0,comments:0};var P=U,D=a(10),R=function(e){var t=function(t){return r.a.createElement(k.Consumer,null,function(a){return r.a.createElement(e,Object.assign({user:a},t))})};return t.displayName="withUser(".concat(function(e){return e.displayName||e.name||"MyComponent"}(t),")"),t},I=R(function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={title:"",content:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(D.a)({},n,r))},a.handleSubmit=function(){var e=Object(h.a)(p.a.mark(function e(t){var n,r,c,o,i,l,s,u,m,d;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=a.state,r=n.title,c=n.content,o=a.props.user,i=o.uid,l=o.displayName,s=o.email,u=o.photoURL,m=function(e){v.collection("posts").add(e)},d={title:r,content:c,user:{uid:i,displayName:l,email:s,photoURL:u},favorites:0,comments:0,createdAt:new Date},m(d),a.setState({title:"",content:""});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.title,a=e.content;return console.log(this.props),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"AddPost"},r.a.createElement("input",{type:"text",name:"title",placeholder:"Title",value:t,onChange:this.handleChange}),r.a.createElement("input",{type:"text",name:"content",placeholder:"Body",value:a,onChange:this.handleChange}),r.a.createElement("input",{className:"create",type:"submit",value:"Create Post"}))}}]),t}(n.Component)),F=function(e){return Object(d.a)({id:e.id},e.data())},L=Object(n.createContext)(),B=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={posts:[]},a.unsubscribeFromFirestore=null,a.unsubscribeFromAuth=null,a.componentDidMount=function(){a.unsubscribeFromFirestore=v.collection("posts").onSnapshot(function(e){var t=e.docs.map(function(e){return F(e)});a.setState({posts:t})})},a.componentWillUnmount=function(){a.unsubscribeFromFirestore()},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.posts,t=this.props.children;return r.a.createElement(L.Provider,{value:e},t)}}]),t}(n.Component),W=function(){var e=Object(n.useContext)(L);return r.a.createElement("section",{className:"Posts"},r.a.createElement(I,null),e.map(function(e){return r.a.createElement(P,Object.assign({},e,{key:e.id}))}))},M=function(e){var t=e.displayName,a=e.photoURL,n=e.email,c=e.createdAt,o=e.children;return r.a.createElement("section",{className:"CurrentUser"},r.a.createElement("div",{id:"update-notification"}),r.a.createElement("div",{className:"CurrentUser--profile"},a&&r.a.createElement("img",{src:a,alt:t}),r.a.createElement("div",{className:"CurrentUser--information"},r.a.createElement(x.a,{to:"/profile"},r.a.createElement("h2",null,t)),r.a.createElement("p",{className:"email"},n),r.a.createElement("p",{className:"created-at"},S()(c.toDate()).calendar()))),r.a.createElement("div",null,r.a.createElement("div",null,o),r.a.createElement("button",{onClick:j},"Sign Out")))};M.defaultProps={displayName:"Bill Murray",email:"billmurray@mailinator.com",photoURL:"https://www.fillmurray.com/300/300",createdAt:new Date};var T=M,q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(D.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault(),a.setState({email:"",password:""})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password;return r.a.createElement("form",{className:"SignIn",onSubmit:this.handleSubmit},r.a.createElement("h2",null,"Sign In"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:t,onChange:this.handleChange}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:a,onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Sign In"}),r.a.createElement("button",{onClick:g},"Sign In With Google"))}}]),t}(n.Component),G=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={displayName:"",email:"",password:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(D.a)({},n,r))},a.handleSubmit=function(){var e=Object(h.a)(p.a.mark(function e(t){var n,r,c,o,i,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.state,r=n.email,c=n.password,o=n.displayName,e.prev=2,e.next=5,y.createUserWithEmailAndPassword(r,c);case 5:i=e.sent,l=i.user,C(l,{displayName:o}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),alert(e.t0);case 13:a.setState({displayName:"",email:"",password:""});case 14:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.displayName,a=e.email,n=e.password;return r.a.createElement("form",{className:"SignUp",onSubmit:this.handleSubmit},r.a.createElement("h2",null,"Sign Up"),r.a.createElement("input",{type:"text",name:"displayName",placeholder:"Display Name",value:t,onChange:this.handleChange}),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:a,onChange:this.handleChange}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:n,onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Sign Up"}))}}]),t}(n.Component),J=function(){return r.a.createElement("div",null,r.a.createElement(q,null),r.a.createElement(G,null))},z=function(){var e=Object(n.useContext)(k);return r.a.createElement("div",null,e?r.a.createElement(T,e):r.a.createElement(J,null))},H=a(47),K=a(46),Z=function(e){var t=e.children,a=Object(n.useRef)(null);if(!a.current){var o=document.createElement("div");o.style.background="green",a.current=o}return Object(n.useEffect)(function(){var e=document.getElementById("update-notification");return e.appendChild(a.current),function(){return e.removeChild(a.current)}},[]),Object(c.createPortal)(r.a.createElement("div",null,t),a.current)},Q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={displayName:"",updated:!1},a.imageInput=null,a.handleChnage=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(D.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state.displayName;t&&a.userRef.update({displayName:t}).then(function(){a.setState(function(){return{updated:!0}},function(){return setTimeout(function(){return a.setState({updated:!1})},2e3)})});a.file&&(console.log("######################",a.file),O.ref().child("user-profiles").child(a.uid).child(a.file.name).put(a.file).then(function(e){return console.log("*********"),e.ref.getDownloadURL()}).then(function(e){return a.userRef.update({photoURL:e})}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.displayName,n=t.updated;return console.log("UPDATED",n),r.a.createElement("section",{className:"UserProfile"},n?r.a.createElement(Z,null,"Updated!"):null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{type:"text",value:a,name:"displayName",onChange:this.handleChnage,placeholder:"Display Name"}),r.a.createElement("input",{type:"file",ref:function(t){return e.imageInput=t},accept:"image/png, image/jpeg"}),r.a.createElement("input",{type:"submit",className:"update"})))}},{key:"uid",get:function(){return y.currentUser.uid}},{key:"userRef",get:function(){return v.doc("users/".concat(this.uid))}},{key:"file",get:function(){return this.imageInput&&this.imageInput.files[0]}}]),t}(n.Component),V=function(e){var t=e.content,a=e.user,n=e.createdAt;return r.a.createElement("article",{className:"Comment"},r.a.createElement("span",{className:"Comment--author"},a.displayName),r.a.createElement("span",{className:"Comment--content"},t),r.a.createElement("span",{className:"Comment--timestamp"},S()(n).calendar()))};V.defaultProps={title:"An Incredibly Hot Take",content:"Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ducimus est aut dolorem, dolor voluptatem assumenda possimus officia blanditiis iusto porro eaque non ab autem nihil! Alias repudiandae itaque quo provident.",user:{displayName:"Bill Murray",email:"billmurray@mailinator.com",photoURL:"https://www.fillmurray.com/300/300"},createdAt:new Date};var X=V,Y=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={content:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(D.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault(),a.props.onCreate(a.state),a.setState({content:""})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.content;return r.a.createElement("form",{onSubmit:this.handleSubmit,className:"AddComment"},r.a.createElement("input",{type:"text",name:"content",placeholder:"Comment",value:e,onChange:this.handleChange}),r.a.createElement("input",{className:"create",type:"submit",value:"Create Comment"}))}}]),t}(n.Component),$=function(e){var t=e.comments,a=e.onCreate;return r.a.createElement("section",{className:"Comments"},r.a.createElement(Y,{onCreate:a}),t.map(function(e){return r.a.createElement(X,Object.assign({},e,{key:e.id}))}))},_=R(function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={post:null,comments:[]},a.unsubscribeFromPosts=null,a.unsubscribeFromComments=null,a.componentDidMount=Object(h.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.unsubscribeFromPosts=a.postRef.onSnapshot(function(e){var t=F(e);console.log(e),a.setState({post:t})}),a.unsubscribeFromComments=a.comementsRef.onSnapshot(function(e){var t=e.docs.map(F);a.setState({comments:t})});case 2:case"end":return e.stop()}},e)})),a.componentWillUnmount=function(){a.unsubscribeFromPosts(),a.unsubscribeFromComments()},a.createComment=function(e){var t=a.props.user;a.comementsRef.add(Object(d.a)({},e,{user:t}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.post,a=e.comments;return console.log(this.props),r.a.createElement("section",null,t&&r.a.createElement(P,t),r.a.createElement($,{comments:a,onCreate:this.createComment}))}},{key:"postId",get:function(){return this.props.match.params.id}},{key:"postRef",get:function(){return v.doc("/posts/".concat(this.postId))}},{key:"comementsRef",get:function(){return this.postRef.collection("comments")}}]),t}(r.a.Component)),ee=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("main",{className:"Application"},r.a.createElement(x.a,{to:"/"},r.a.createElement("h1",null,"Think Piece")),r.a.createElement(z,null),r.a.createElement(H.a,null,r.a.createElement(K.a,{exact:!0,path:"/",component:W}),r.a.createElement(K.a,{exact:!0,path:"/profile",component:Q}),r.a.createElement(K.a,{exact:!0,path:"/posts/:id",component:_})))}}]),t}(n.Component),te=a(45);Object(c.render)(r.a.createElement(te.a,null,r.a.createElement(B,null,r.a.createElement(A,null,r.a.createElement(ee,null)))),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.163a6a11.chunk.js.map